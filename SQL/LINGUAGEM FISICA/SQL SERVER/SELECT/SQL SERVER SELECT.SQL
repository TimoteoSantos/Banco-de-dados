/* NESTE JOI TRAZEMOS TODOS OS DADOS QUE TEM RELACAO COM A TABELA C*/

SELECT *
FROM [Cadastro de mercadorias] AS C
JOIN [Cadastro de mercadoriasLojas] AS CL
ON C.[Código da Mercadoria] = cl.[Código da Mercadoria]
WHERE C.[Código da Mercadoria] = '5'

/*NESTE JOIN PODEMOS ESCPECIFICAR QUAIS CAMPOS IRAO SER VIZIVEIS NA CONSULTA
  PERCEBA QUE NAO FOI ESPECIFICADO OS CAMPOS DE ID QUE UNEM AS TABELAS NAO É OBRIGATORIO
*/

SELECT C.Mercadoria, CL.Loja
FROM [Cadastro de mercadorias] AS C
JOIN [Cadastro de mercadoriasLojas] AS CL
ON C.[Código da Mercadoria] = cl.[Código da Mercadoria]
WHERE C.[Código da Mercadoria] = '5'

/*SEM USAR JOIS É POSSIVEL ASSOCIAR VINCULANDO APENAS AS CHAVES QUE QUEREMOS*/

SELECT * FROM [Cadastro de mercadorias] AS MERCADORIAS ,
[Cadastro de mercadoriasLojas] AS MERCADORIASLOJAS
WHERE MERCADORIAS.[Código da Mercadoria] = MERCADORIASLOJAS.[Código da Mercadoria]
AND MERCADORIAS.[Código da Mercadoria] = '5'

/*
Exercicio juntando duas tabelas com join
PARA JUNTAR AS DUAS TABELAS POR JOIN
1 FAZER UM SELECT APELIDANDO AS TABELAS ENTRE AS TABELAS FICA A PALAVRA JOIN 
ENTRE AS CONDICOES FICA A PALAVRA ON
FROM ALUNO AS AL JOIN TURMA AS TR ON AL.ID = TR.ID
NESTE EXEMPLO JUNTAMOS DUAS TABELAS POR JOIN
*/

SELECT * FROM
[Cadastro de mercadorias] AS MERCADORIA
JOIN
[Cadastro de mercadoriasLojas] AS LOJAS
ON MERCADORIA.[Código da Mercadoria] = LOJAS.[Código da Mercadoria]

/*
COM INNER JOIN SAO CARREGADOS TODOS OS DADOS QUE TEM RELACAO MAS SO OS QUE TEM RELACAO
NESTE EXEMPLO NA MOSTRA NADA PORQUE ELE SO MOSTRA OS QUE TEM RELACAO
*/

SELECT LOJAS.[Código da Mercadoria] FROM
[Cadastro de mercadorias] AS MERCADORIA
INNER JOIN
[Cadastro de mercadoriasLojas] AS LOJAS
ON MERCADORIA.[Código da Mercadoria] = LOJAS.[Código da Mercadoria]
WHERE LOJAS.[Código da Mercadoria] IS NULL

/*
O LEFT JOIN MOSTRA TODOS OS DADOS INCLUSIVE OS QUE NAO TEM RELACAO A ESQUERDA
NESTE EXEMPLO ELE MOSTRA MESMO QUE NAO TENHA DADOS
*/

SELECT LOJAS.[Código da Mercadoria] FROM
[Cadastro de mercadorias] AS MERCADORIA
LEFT JOIN
[Cadastro de mercadoriasLojas] AS LOJAS
ON MERCADORIA.[Código da Mercadoria] = LOJAS.[Código da Mercadoria]
WHERE LOJAS.[Código da Mercadoria] IS NULL

/*O LEFT JOIN MOSTRA TODOS OS DADOS INCLUSIVE OS QUE NAO TEM RELACAO A DIREITA*/

SELECT LOJAS.[Código da Mercadoria] FROM
[Cadastro de mercadorias] AS MERCADORIA
RIGHT JOIN
[Cadastro de mercadoriasLojas] AS LOJAS
ON MERCADORIA.[Código da Mercadoria] = LOJAS.[Código da Mercadoria]
WHERE LOJAS.[Código da Mercadoria] IS NULL


/*FULL JOIN TANTO DA ESQUERDA QUANTO DA DIREITA SAO RETORNADOS*/

SELECT LOJAS.[Código da Mercadoria] FROM
[Cadastro de mercadorias] AS MERCADORIA
FULL JOIN
[Cadastro de mercadoriasLojas] AS LOJAS
ON MERCADORIA.[Código da Mercadoria] = LOJAS.[Código da Mercadoria]
WHERE LOJAS.[Código da Mercadoria] IS NULL

/*
CROSS ASSOCIA TODOS OS DADOS DA DIREITA A UM DA ESQUERDA 
EXEMPLO
TODOS OS ALUNOS PERTENCEM A TODAS
AS SALAS PARA FAZER REPETIR PARA CADA ALUNO UMA SALA
OU CADA SALA TER TODOS OS ALUNOS 
NAO USA ON JA QUE TODOS RECEBERAM TUDO
*/

SELECT * FROM
[Cadastro de mercadorias] AS MERCADORIA
CROSS JOIN
[Cadastro de mercadoriasLojas] AS LOJAS

WHERE MERCADORIA.[Código da Mercadoria] = '5'
/*PARA CADA PRODUTO DE LOJA RECEBERA A MERCADORIA DE CODIGO 5*/


/*
NESSE EXEMPLO ESTAMOS MOSTRANDO TODOS OS PRODUTOS QUE NAO TEM UM SIMILAR ASSOCIADO
A TABELA DA ESQUERDA SAO OS PRODUTOS E A DIREITA OS SIMILARES TEM PRODUTOS QUE NAO TEM SIMILARES
*/

SELECT M.CodigoSimilar, S.Registro FROM [Cadastro de mercadorias] AS M
RIGHT JOIN CadastroSimilares AS S
ON M.CodigoSimilar = S.Registro
WHERE M.CodigoSimilar IS NULL